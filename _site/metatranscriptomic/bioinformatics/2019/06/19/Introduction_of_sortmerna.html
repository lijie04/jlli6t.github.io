<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" href="/assets/css/normalize.css"/>
	<link rel="stylesheet" href="/assets/css/open-color.css"/>
	<link rel="stylesheet" href="/assets/css/tao/styles.css"/>

  <script async src="https://use.fontawesome.com/releases/v6.0.0/js/all.js"></script>

  

</head>

  <body>
    <div class="wrapper">
      <header class="masthead">
  <h2 class="masthead-title">
    <a href="/"><font color=red>❤️</font> Jie Li (She/Her/Hers) <font color=red>❤️</font></a>
  </h2>
  
    <h5 class="masthead-tagline">A PhD student interested in microbial ecology</h5>
  
  
    <nav class="nav">
      
        <a class="nav-item " href="/about/">
          <u>About</u>
        </a>
      
        <a class="nav-item " href="/home/index.html">
          <u>Blogs</u>
        </a>
      
        <a class="nav-item " href="/categories/index.html">
          <u>Categories</u>
        </a>
      
        <a class="nav-item " href="/tags/index.html">
          <u>Tags</u>
        </a>
      
        <a class="nav-item " href="/years/index.html">
          <u>Years</u>
        </a>
      
        <a class="nav-item " href="/projects/index.html">
          <u>Projects</u>
        </a>
      
        <a class="nav-item " href="/cv/">
          <u>_CV_</u>
        </a>
      
      </nav>
  
</header>

      <main>
        <article class="post">
  <div class="post-meta post-meta-top">
    <div>
      <time datetime="2019-06-19T00:00:00+10:00">
        <i class="fa-solid fa-calendar-days"></i> 19 Jun 2019
      </time><i class="fa-solid fa-at"></i>
        
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">Jie Li</span></div>

    
      <nav class="post-categories">
        
          
            <a class="post-category" href="/categories/#metatranscriptomic">metatranscriptomic</a> /
          
        
          
            <a class="post-category" href="/categories/#bioinformatics">bioinformatics</a> /
          
        
      </nav>
    
  </div>

  <h1 class="post-title">Introduction to SortMeRNA</h1>
  

  

  <div class="post-content">
    <p><img src="/assets/picbed/post/sortmerna_title.png" alt="" /></p>
<h2 id="1-introduction">1. Introduction</h2>
<p>SortMeRNA是一款设计用于去除宏转录组数据中的核糖体RNA的工具，由Dr. Evguenia Kopylova小姐姐一作开发，发表于Bioinformatics，她目前依然活跃在这款软件的维护社区。目前已更新到4.2.0版本。引用次数920，github星标83，Fork38， Watch14。</p>

<h2 id="2-算法基本原理">2. 算法基本原理</h2>
<p>底层算法与seed策略类似，主要是寻找rRNA数据库和read之间的一定数量的相似短区域。对rRNA序列建立索引的时候，与HMM一样，利用同源序列之间的冗余，建立所有rRNA序列的压缩模型。
然后设定一个窗口，对read进行窗口滑动扫描，基于设定的阈值，单个read中超过阈值数量的窗口比对到数据库则该read被鉴定为rRNA。其中窗口比对数据库时容错为1（例如碱基替换，插入或缺失）。
基础算法很容易理解，主要是提高算法效率，大比例缩短比对时间。
作者的策略如下图所示：</p>

<p><img src="/assets/picbed/post/sortmerna_algorithm.png" alt="" /></p>

<h3 id="21-具体算法过程">2.1 具体算法过程</h3>
<ol>
  <li>使用<code class="language-plaintext highlighter-rouge">Burst trie (BT)</code>结合查找表策略存储数据库。假设窗口为<code class="language-plaintext highlighter-rouge">w</code>，窗口序列长度为<code class="language-plaintext highlighter-rouge">s（14~20）</code>。
1a，首先存储了数据库中每一个<code class="language-plaintext highlighter-rouge">s/2-mer</code>序列的出现频次（#occ）
1b，BT的结构，这个跟搜索树结构很像了，类比即可</li>
  <li>处理输入read。同样窗口为w, 窗口长度为s，向右滑动。
2a, 滑动窗口示意图
2b, 将窗口分为窗口前段从<code class="language-plaintext highlighter-rouge">w[1..s/2 +1]</code>，和窗口后段<code class="language-plaintext highlighter-rouge">w[s..s/2 + 1]</code></li>
  <li>判断窗口序列在BT中是否存在。通过通用Levenshtein自动机和BT循环遍历，及确保错误不大于1。
遍历完所有的窗口后，判断接受的窗口数量是否高于阈值，高于阈值则认为该输入read判定为rRNA。</li>
</ol>

<h3 id="22-算法小结">2.2 算法小结</h3>
<p>总结思路：输入read，生成第一个窗口序列，先查找前半段窗口序列在数据库中的频次，达到要求则定位这半段序列在BT中的位置，然后开始在BT搜索（burst）后半段窗口的序列，沿着BT把整个窗口遍历完，最后如果遍历的时候发现的错误&gt;1，则把这个窗口记录为非比对；接着滑动到下一个窗口从头开始判定，直到所有的窗口判定完成后，如果判定为比对的窗口的数量&gt;给定的阈值，则判定read为rRNA。</p>

<h2 id="3关于作者使用的levenshtein自动机">3.关于作者使用的Levenshtein自动机</h2>
<p>作者用自动机实现字符串之间的模糊匹配（文中是read和db）。假设字符串p和错误数k，经典的非确定性Levenshtein自动机可识别的最大编辑距离为k到p的字符集，文中k=1。
<img src="/assets/picbed/post/sortmerna_levenshtein.png" alt="" /></p>

<h2 id="4-与其他工具的对比">4. 与其他工具的对比：</h2>
<p>Meta-RNA，SSU-ALIGN，rRNASelector使用了常见的概率模型，其中Meta-RNA和rRNASelector使用了HMM模型，然后利用HMMER3比对短read到数据库，SSU-ALIGN使用协方差模型来支持二级结构的信息。除了概率模型之外，riboPicker使用的是修改版的BWA算法。BLASTN也使用非常多，特别是大家各自用的workflow。</p>

<h2 id="总结">总结：</h2>
<p>文章是12年发表，除了文章中提到的工具，后来大家各自用的<code class="language-plaintext highlighter-rouge">workflow</code>也有很多用<code class="language-plaintext highlighter-rouge">bwa</code>，<code class="language-plaintext highlighter-rouge">bowtie</code>，<code class="language-plaintext highlighter-rouge">bowtie2</code>等工具进行比对的。其次就是这个算法策略对错误的容忍低（为1）。再有就是作者使用的<code class="language-plaintext highlighter-rouge">universal Levenshtein</code>自动机，越看越像马尔科夫链，可能是我对自动机的理解还不够深？
其次是对于作者，EK小姐姐至今仍然在一线社区活跃。</p>

  </div>

  
    <nav class="post-meta post-meta-bottom">
      
        
        
          <a class="post-tag" href="/tags/#tutorials">#tutorials</a>
        
      
        
        
          <a class="post-tag" href="/tags/#rna">#rna</a>
        
      
        
        
          <a class="post-tag" href="/tags/#mapping">#mapping</a>
        
      
    </nav>
  
</article>

<div class="pagination">
  
    <a class="prev post-prev" href="/coding/bash/2019/06/17/git_local_repo.html">
      <i class="fas fa-chevron-left"></i> <span class="">Learning git - local repo
</span>
    </a>
  

  
    <a class="next post-next" href="/coding/python/2019/07/21/Comparison_of_Seqs_iterator.html">
      <span class="">Comparison of Seqs iterator
</span> <i class="fas fa-chevron-right"></i>
    </a>
  
</div>



      </main>
      <footer class="footer">
  
  <div class="social">
    
      <a href="https://scholar.google.com/citations?hl=zh-CN&user=s_Uga6sAAAAJ" target="_blank">
        <i class="fab fa-google" title="Google scholar"></i>
      </a>
    
      <a href="https://github.com/jlli6t" target="_blank">
        <i class="fab fa-github" title="Github"></i>
      </a>
    
      <a href="https://www.linkedin.com/in/jie-li-3201a57b/" target="_blank">
        <i class="fab fa-linkedin" title="linkedin"></i>
      </a>
    
      <a href="https://orcid.org/0000-0002-9623-9213" target="_blank">
        <i class="fa-brands fa-orcid" title="ORCID"></i>
      </a>
    
      <a href="https://twitter.com/jlli6t" target="_blank">
        <i class="fab fa-twitter" title="Twitter"></i>
      </a>
    
      <a href="https://jlli6t.github.io" target="_blank">
        <i class="fas fa-link" title="Website"></i>
      </a>
    
      <a href="mailto:jlli6t@gmail.com" target="_blank">
        <i class="fas fa-envelope" title="Email"></i>
      </a>
    
  </div>
  

  <div class="columns">
    <p class="column">
      &copy; <time datetime="2022-06-25T00:05:42+10:00">2022</time>&nbsp;<a href="/" target="_blank">Jie Li</a>. All rights reserved.
    </p>

    <p class="column">
      Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a> & <a href="https://github.com/vfvong" target="_blank">vfvong</a>
    </p>

    
    <p class="column">
      <a href="/" target="_blank">Passion can get you through the long years <font color=F08F8F>❤</font> 热爱可抵岁月漫长</a>
    </p>
    
  </div>

  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">
    <center><a href="/" target="_blank">Total visits: <span id="busuanzi_value_site_pv"> </span> <font color=F08F8F>❤</font> Jie Li</a></center>
  </span>
</footer>

    </div>

    

    
  </body>
</html>
